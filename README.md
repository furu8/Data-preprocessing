# Data-preprocessing

## 3.構造化データ1

## 5.画像データ

- データセットが虫なので耐性ない方はご注意を

### 1.データ理解

#### opencvの利用

- カラー画像（RGB）
- グレースケール画像（白黒）
- 2値化画像（白or黒）

#### 画像をデータとしてみる
    
- ピクセル単位
- ピクセルの行列（numpy）
- ピクセルの行列（pandas）

### 2.機械学習のためのデータ準備

#### モルフォロジー変換

- フィルタのサイズは任意

- 収縮(Erosion)
    - 画像のフィルタ内のピクセルの値が全て1(白)なら1を出力
    - 特徴量の丸め込みが目的

- 膨張(Dilation)
    - 画像のフィルタ内のピクセルの値が一つでも1(白)なら1を出力
    - 特徴量の丸め込みが目的

- オープニング(Opening)
    - 収縮の後で膨張している
    - ノイズ除去が目的

- クロージング(Closing)
    - 膨張の後で収縮している
    - ノイズ除去が目的

#### 次元圧縮

- ピクセル値をそのまま特徴量として使うのではなく、要約すると良い場合がある
    - RGB、グレースケールのヒストグラムによる頻度の可視化

- 要約するために次元圧縮を用いる
    - 主成分分析(PCA)
    - t-SNE

### 3.深層学習のためのデータ準備

#### 深層学習

- 学習することで、ネットワークの中間層の重み（特徴量）を自動的に最適化
- 画像の場合、画像のどの位置に特徴点があるか考慮でき、その位置のずれを吸収できる
- 結果に対しての根拠を説明できない問題がある

#### CNN

- 畳み込み層
    - 入力データに対して、重みを持つフィルタをずらしながら適用し、ノードのデータと重みをかけて足し合わせることで、特徴量を抽出
    - ゼロパディング：畳み込み層で入力データよりもサイズが小さくなったときに、0埋めすることで、データサイズを同じにすること

- プーリング層
    - 畳み込みで出力された特徴量に対し、一定の領域内における最大値（必ずしも最大値ではない。平均値の場合もある）を残し、重要な重みを残す

#### 画像データの水増し

- 画像の反転
    - 上下反転、左右反転、上下左右反転など

- 画像の平滑化
    - 画像の像をぼかすこと
    - 平均値ぼかし：一様の重みフィルタを使って領域内のピクセル値の平均をとる
    - ガウシアンぼかし：ガウス分布に従って重みを付与し、ピクセル値の平均をとる
    - 中央値ぼかし：一様の重みフィルタを使って領域内のピクセル値の平均をとる

- 画像の明度
    - 画像の明るさを変える


## 6.時系列データ






## 参考

### 機械学習のための「前処理」入門

- 足立 悠
- リックテレコム
